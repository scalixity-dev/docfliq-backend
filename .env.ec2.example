# ──────────────────────────────────────────────────────────────
# Docfliq EC2 Deployment — Environment Variables
# Copy to .env.ec2 and fill in production values
#
# Usage (all-in-one):
#   docker compose -f docker-compose.ec2.yml --env-file .env.ec2 --profile all up -d --build
#
# Usage (pick services):
#   docker compose -f docker-compose.ec2.yml --env-file .env.ec2 --profile identity --profile redis --profile nginx up -d --build
# ──────────────────────────────────────────────────────────────

# ── RDS (PostgreSQL) ─────────────────────────────────────────
# Point to your AWS RDS instance
IDENTITY_DATABASE_URL=postgresql+asyncpg://docfliq:YOUR_RDS_PASSWORD@your-rds-host.region.rds.amazonaws.com:5432/identity_db
CONTENT_DATABASE_URL=postgresql+asyncpg://docfliq:YOUR_RDS_PASSWORD@your-rds-host.region.rds.amazonaws.com:5432/content_db

# ── JWT (must match across ALL machines / services) ──────────
JWT_SECRET=CHANGE_ME_RANDOM_64_CHAR_STRING
JWT_ALGORITHM=HS256
JWT_ISSUER=docfliq-identity
JWT_AUDIENCE=docfliq-services
JWT_EXPIRE_SECONDS=900
JWT_REFRESH_EXPIRE_SECONDS=604800

# ── App ──────────────────────────────────────────────────────
ENV_NAME=production
CORS_ORIGINS=https://yourdomain.com,https://admin.yourdomain.com
APP_BASE_URL=https://yourdomain.com

# ── SSL domain (used in nginx.ec2.conf) ──────────────────────
DOMAIN=api.yourdomain.com

# ── Inter-service URLs ───────────────────────────────────────
# Defaults work when both services run on the same machine (Docker DNS).
# Override when services are on different machines:
#   CONTENT_SERVICE_URL=http://<content-machine-ip>:8002/api/v1
#   IDENTITY_SERVICE_URL=http://<identity-machine-ip>:8001/api/v1
#   REDIS_URL=redis://<redis-machine-ip>:6379/0
#   OPENSEARCH_URL=http://<opensearch-machine-ip>:9200
# CONTENT_SERVICE_URL=http://content:8000/api/v1
# IDENTITY_SERVICE_URL=http://identity:8000/api/v1
# REDIS_URL=redis://redis:6379/0
# OPENSEARCH_URL=http://opensearch:9200

# ── Host port bindings (for multi-machine access) ────────────
# Default: 127.0.0.1 (localhost only, nginx proxies).
# For multi-machine: bind to 0.0.0.0 so other machines can reach this service.
# IDENTITY_HOST_PORT=0.0.0.0:8001
# CONTENT_HOST_PORT=0.0.0.0:8002

# ── OpenSearch ───────────────────────────────────────────────
OPENSEARCH_INDEX_PREFIX=docfliq
# Set to false if OpenSearch is not on this machine and not reachable yet
# OPENSEARCH_ENABLED=true

# ── SMTP (CiNet / Postal — primary email) ───────────────────
SMTP_HOST=
SMTP_PORT=25
SMTP_USERNAME=
SMTP_PASSWORD=
SMTP_FROM_EMAIL=noreply@yourdomain.com
SMTP_FROM_NAME=DOCFLIQ
SMTP_START_TLS=true

# ── Brevo (fallback email) ──────────────────────────────────
BREVO_API_KEY=
BREVO_FROM_EMAIL=noreply@yourdomain.com
BREVO_FROM_NAME=DOCFLIQ

# ── Twilio Verify (SMS OTP) ─────────────────────────────────
TWILIO_ACCOUNT_SID=
TWILIO_AUTH_TOKEN=
TWILIO_VERIFY_SERVICE_SID=

# ── OAuth SSO ────────────────────────────────────────────────
GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=
MICROSOFT_CLIENT_ID=
MICROSOFT_CLIENT_SECRET=

# ── AWS / S3 ────────────────────────────────────────────────
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_REGION=ap-south-1
S3_BUCKET=docfliq-user-content-prod
